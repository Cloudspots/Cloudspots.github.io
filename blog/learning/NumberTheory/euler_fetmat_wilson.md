# 欧拉定理、费马小定理与威尔逊定理

## 前置知识

完全剩余系（文章名称：residue.\*）。

## 费马小定理

如果 $p$ 是质数，$a$ 与 $p$ 互质，那么 $a^{p-1}\equiv 1\pmod p$（或者 $a^p\equiv a\pmod p$）。

证明：考虑模 $p$ 简化剩余系，此时等价于去掉 $0$ 的完全剩余系。将其元素积记为 $M$，显然 $M\perp p$。

那么将这个简系所有元素乘 $a$，得到元素积为 $a^{p-1}M$，结果还是简系，所以 $a^{p-1}M\equiv M\pmod p$，也就是 $(a^{p-1}-1)M\equiv 0\pmod p$，而 $M \perp p$，所以 $a^{p-1}-1\equiv 0\pmod p$，证毕。

## 欧拉定理

费马小定理加强版。$p$ 可以不是质数，则 $a^{\varphi(p)}\equiv 1\pmod p$。

证明：费马小定理的证明去除掉“此时等价于去掉 $0$ 的完全剩余系”这句话就可以完全套用到这里。

## 威尔逊定理

当 $p\ge 2$ 时，$p$ 是质数等价于 $(p-1)!\equiv -1\pmod p$。

> 还有更炫酷的形式，那就是 $p$ 是质数当且仅当 $\sin\left(\dfrac{((p-1)!+1)\pi}{p}\right)=0$。
>
> 显然这个和上面的命题等价。

证明：

首先如果 $(p-1)!\equiv -1\pmod p$，那么 $(p-1)!\perp p$，所以 $\forall 1\le i<p, i\perp p$，所以 $p$ 是质数。

然后如果 $p$ 是质数，首先直接算出 $p=2$ 的结果，当 $p\ge 3$ 时根据乘法逆元（数论倒数）的唯一存在性，$[1,p)$ 中所有数字的乘法逆元都唯一存在，而乘法逆元为它本身的 $i$ 满足 $i^2\equiv 1\pmod p$，也就是 $(i-1)(i+1)\equiv 0\pmod p$，得到 $i\equiv \pm 1\pmod p$。经验证确实成立，所以是充要的。所以除了 $1$ 和 $p-1$，剩下的数都可以两两配对积为 $1$，那么乘积为 $(p-1)\times 1\times 1^{\frac{p-3}{2}}\equiv -1\pmod p$。证毕。

## 用处

前两个可以计算乘法逆元，威尔逊定理的好像在 OI 中没啥用。
