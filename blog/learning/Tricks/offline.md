# 浅谈离线技巧

## 引入

考虑这样一个经典问题：给定一张无向图和若干次操作，每次操作删除一条边（保证存在），最后图被删空。每次操作完成之后返回图是否连通。

这题显然能用二分做。但是，我们有更优秀的做法：离线算法。在这种情况下，又称作时光倒流！

我们反着考虑。每次添加一条边，返回是否连通。显然能用并查集做。所以时间复杂度是 $\mathcal O(n+m\alpha(n))$（$n$ 是点数，$m$ 是边数），比二分的 $\mathcal O(m \log n)$ 优秀多了！

另外一个问题（嗯对对，在目前的洛谷题库上搜索“离线处理”标签最低难度的题）：给定长度最大为 $10^4$ 的序列 $a$，$q$ 次询问，每次求 $(a_l)\oplus (a_l+a_{l+1}) \oplus (a_l+a_{l+1}+a_{l+2}) \oplus \cdots \oplus (a_l+a_{l+1}+a_{l+2}+\cdots+a_r)=\displaystyle \bigoplus_{i=l}^r \sum_{j=l}^i a_j$。

解法是，注意到序列长度较小并且递推可以做到 $\mathcal O(n^2)$ 求出所有子串（指连续子序列）的答案。注意到空间爆炸。但是，空间只是存下来所有答案的空间！递推空间复杂度本身是常数级别的！

所以！我们可以先把所有询问处理下来，然后每次递推到一个答案的时候判断是否有问这个问题的答案，如果有就回答这个问题，没有就忽略，最后输出所有问题的答案！时间复杂度 $\Theta(n^2+q)$！

## 所以，什么是离线？

想象有人问你一堆问题，但你现在不想回答。而对这些问题重新排列后，变得更加容易回答了。于是你回答了这些问题，并重新排序为了原本询问的顺序，回答给那个人。


